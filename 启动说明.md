# 大模型安全检测工具 - 启动说明

## 🚀 快速启动（推荐开发环境）

### 方式1：使用快速启动脚本（最快，约10秒）

```bash
# 双击运行或在命令行执行
start.bat
```

**特点**：
- ✅ 启动速度最快（约10秒）
- ✅ 支持热重载，修改代码立即生效
- ✅ 调试方便，可直接看到日志
- ⚠️  需要保持CMD窗口运行

**服务架构**：
- PostgreSQL & Redis → Docker容器
- 后端服务 → 本地Python进程
- 前端服务 → 本地Node.js进程

---

### 方式2：完整Docker启动（生产环境）

```bash
# 双击运行或在命令行执行
start-docker.bat
```

**特点**：
- ✅ 所有服务都在容器中，环境隔离
- ✅ 适合生产环境部署
- ❌ 启动较慢（2-3分钟）
- ❌ 不支持热重载，修改需重新构建

---

## 🛑 停止服务

```bash
# 双击运行
stop.bat
```

或手动操作：
1. 关闭后端和前端的CMD窗口
2. 执行 `docker-compose down` 停止数据库容器

---

## 📋 手动启动步骤

如果你想手动控制每个服务：

### 1. 启动数据库（Docker）

```bash
docker-compose up -d postgres redis
```

### 2. 启动后端（新开CMD窗口）

```bash
cd backend
python simple_server.py
```

### 3. 启动前端（新开CMD窗口）

```bash
cd frontend
npm run dev
```

---

## 🌐 访问地址

启动成功后，可访问以下地址：

| 服务 | 地址 | 说明 |
|------|------|------|
| **前端应用** | http://localhost:3001 | 主要界面 |
| **后端API** | http://localhost:8000 | API接口 |
| **API文档** | http://localhost:8000/docs | Swagger文档 |
| **PostgreSQL** | localhost:5432 | 数据库 |
| **Redis** | localhost:6379 | 缓存 |

---

## 🔍 故障排查

### 问题1：端口被占用

```bash
# 检查端口占用
netstat -ano | findstr ":8000"
netstat -ano | findstr ":3001"

# 杀死占用进程
taskkill /PID <进程ID> /F
```

### 问题2：Docker启动失败

```bash
# 检查Docker状态
docker ps

# 重启Docker Desktop
```

### 问题3：前端无法连接后端

检查 `frontend/.env.development` 中的API地址是否正确：
```
VITE_API_BASE_URL=http://localhost:8000/api/v1
```

---

## 📊 启动方式对比

| 特性 | 快速启动 | 完整Docker |
|------|---------|-----------|
| 启动时间 | ~10秒 | 2-3分钟 |
| 热重载 | ✅ 支持 | ❌ 不支持 |
| 调试便利 | ✅ 方便 | ⚠️  一般 |
| 环境隔离 | ⚠️  部分 | ✅ 完全 |
| 生产适用 | ❌ 不推荐 | ✅ 推荐 |
| 开发适用 | ✅ 推荐 | ❌ 不推荐 |

---

## 💡 推荐做法

**开发环境**：使用 `start.bat`（快速启动）
**测试环境**：使用 `start-docker.bat`（完整Docker）
**生产环境**：使用 `start-docker.bat` + 配置优化

---

## 📝 修改说明

### 修改代码后

- **快速启动模式**：保存后自动热重载，无需重启
- **完整Docker模式**：需要重新构建镜像
  ```bash
  docker-compose up -d --build
  ```

### 依赖变更

```bash
# 后端依赖
cd backend
pip install -r requirements.txt

# 前端依赖
cd frontend
npm install
```

---

## 🆘 获取帮助

如遇问题，请检查：
1. Docker Desktop是否运行
2. Python版本是否为3.10+
3. Node.js版本是否为16+
4. 端口8000、3001、5432、6379是否被占用
